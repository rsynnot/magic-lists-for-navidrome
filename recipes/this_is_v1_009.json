{
  "recipe_id": "This_Is_Artist_v1_008",
  "name": "Single Artist Metadata & Play Count Based Playlist",
  "user_parameters": {
    "target_artist": "{{TARGET_ARTIST}}",
    "desired_track_count": "{{DESIRED_TRACK_COUNT}}"
  },
  "llm_config": {
    "max_output_tokens": 1500,
    "temperature": 0.6
  },
  "model_instructions": "You are a world-class music curator creating a 'This Is {{TARGET_ARTIST}}' playlist, mimicking the sequencing and flow of a major streaming service editorial playlist. You will select {{DESIRED_TRACK_COUNT}} tracks.\n\nCURATION RULES:\n1. DIVERSITY IS PARAMOUNT: **Crucially, the album of the current track MUST NOT match the album of the previous track.** Mix albums and release years throughout. \n2. Prioritize tracks with high local_library_likes and play_count (10+ plays are major hits). \n3. Ensure chronological breadth by mixing old and new releases. \n4. Vary energy levels and moods. \n5. Start with 2-3 iconic hits (use internal knowledge to identify singles/revered tracks) and end with a memorable track. \n6. Maximum 5 total tracks per album, spread throughout the playlist. \n\nRespond with JSON: {\"track_ids\": [\"id1\", \"id2\", ...], \"reasoning\": \"Write an interesting ~280 character summary of the playlist in the style of a magazine album review.\"}",
  "global_strategy": {
    "final_track_count": "{{DESIRED_TRACK_COUNT}}",
    "tie_breaker_priority": ["local_library_likes", "play_count", "release_year"],
    "weights": {
      "local_library_likes": 0.7,
      "play_count": 0.3,
      "release_year": 0.0,
      "track_name": 0.0
    },
    "waiting": {
      "max_tracks_consecutive_album": 2,
      "max_tracks_per_album": "{{MATH:max(2,ceil(DESIRED_TRACK_COUNT*0.2))}}",
      "min_albums_represented": "{{MATH:max(3,ceil(DESIRED_TRACK_COUNT*0.16))}}"
    }
  },
  "processing_steps": [
    {
      "step_id": 1,
      "title": "Super Hits & User Favorites (Top Priority)",
      "priority_score": 10,
      "target_track_count": "{{MATH:ceil(DESIRED_TRACK_COUNT*0.48)}}",
      "description": "Select the highest-rated and most-played tracks to form the core of the playlist.",
      "filters": [
        {"field": "artist_name", "operator": "EQUAL_TO", "value": "{{TARGET_ARTIST}}"},
        {"field": "local_library_likes", "operator": "EQUAL_TO", "value": true},
        {"field": "play_count", "operator": "GREATER_THAN", "value": 10},
        {"field": "genre", "operator": "IN", "value": "{{STEP1_GENRES_IN}}"}
      ]
    },
    {
      "step_id": 2,
      "title": "Catalogue Fillers (Mid Priority)",
      "priority_score": 7,
      "target_track_count": "{{MATH:ceil(DESIRED_TRACK_COUNT*0.32)}}",
      "description": "Select popular tracks that may not be 'liked' but have high play counts, diversifying across the entire catalogue.",
      "filters": [
        {"field": "artist_name", "operator": "EQUAL_TO", "value": "{{TARGET_ARTIST}}"},
        {"field": "play_count", "operator": "BETWEEN", "value": [3, 10]},
        {"field": "local_library_likes", "operator": "EQUAL_TO", "value": false},
        {"field": "genre", "operator": "NOT_IN", "value": "{{STEP2_GENRES_OUT}}"}
      ]
    },
    {
      "step_id": 3,
      "title": "Essential Album Tracks (Diversity/Lowest Priority)",
      "priority_score": 4,
      "target_track_count": "{{MATH:ceil(DESIRED_TRACK_COUNT*0.2)}}",
      "description": "Fill the remainder with a mix of tracks from different, older albums to ensure the breadth of their career is covered.",
      "filters": [
        {"field": "artist_name", "operator": "EQUAL_TO", "value": "{{TARGET_ARTIST}}"},
        {"field": "release_year", "operator": "LESS_THAN", "value": "{{CUTOFF_YEAR}}"},
        {"field": "genre", "operator": "IN", "value": "{{STEP3_GENRES_IN}}"}
      ]
    }
  ]
}
