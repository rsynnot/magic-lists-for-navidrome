{
  "recipe_id": "Re_Discover_Weekly_v2_Phase2",
  "name": "Re-Discover Weekly v2.0 - Phase 2: Track Sequencing & Flow Optimization",
  "user_parameters": {
    "theme_strategy": "{{theme_strategy}}",
    "candidate_tracks": "{{candidate_tracks}}",
    "num_tracks": "{{num_tracks}}"
  },
  "llm_config": {
    "max_output_tokens": 1500,
    "temperature": 0.4
  },
  "model_instructions": "You are an expert music curator creating the perfect 25-track Re-Discover Weekly playlist. Your task is to select and sequence tracks for optimal listening flow.\n\n## CURATION STRATEGY:\n{{theme_strategy}}\n\n## CANDIDATE TRACKS:\n{{candidate_tracks}}\n\n## SELECTION REQUIREMENTS:\n- Select exactly {{num_tracks}} tracks (25 tracks)\n- Focus on tracks that match the identified theme and strategy\n- Prioritize tracks with higher rediscovery_score\n- Ensure variety: no more than 2 tracks from the same artist\n- Create smooth transitions between tracks\n- Balance energy levels throughout the playlist\n- Start strong, end smoothly\n\n## SEQUENCING PRINCIPLES:\n1. **ENERGY FLOW**: Arrange tracks from high-energy to mellow, or create intentional peaks/valleys\n2. **ARTIST SPREAD**: Distribute tracks from popular artists throughout the playlist\n3. **GENRE COHESION**: Group similar styles while maintaining interest\n4. **TEMPORAL VARIETY**: Mix different eras/decades for 'archaeological' feel\n5. **EMOTIONAL ARC**: Create a satisfying journey from start to finish\n\n## RESPONSE FORMAT:\nReturn a JSON object with this exact structure:\n{\n  \"track_ids\": [\"id1\", \"id2\", ..., \"id25\"],\n  \"reasoning\": \"Detailed explanation of your curation choices, sequencing decisions, and how the playlist achieves the theme. Keep under 280 characters.\"\n}\n\n## QUALITY CRITERIA:\n- Every track must be from the candidate list\n- Exactly 25 tracks (no more, no less)\n- Strong rediscovery potential (high play counts, long time since played)\n- Cohesive yet varied listening experience\n- Matches the theme identified in Phase 1",
  "global_strategy": {
    "final_track_count": "{{num_tracks}}",
    "max_consecutive_artist": 2,
    "prioritize_discovery": true,
    "ensure_flow": true
  },
  "processing_steps": [
    {
      "step_id": 1,
      "title": "Theme Alignment",
      "priority_score": 10,
      "description": "Filter candidates that best match the identified theme"
    },
    {
      "step_id": 2,
      "title": "Quality Selection",
      "priority_score": 8,
      "description": "Select highest-quality tracks based on rediscovery potential"
    },
    {
      "step_id": 3,
      "title": "Flow Sequencing",
      "priority_score": 9,
      "description": "Arrange tracks for optimal listening experience"
    },
    {
      "step_id": 4,
      "title": "Diversity Check",
      "priority_score": 7,
      "description": "Ensure no artist dominates and maintain variety"
    }
  ]
}